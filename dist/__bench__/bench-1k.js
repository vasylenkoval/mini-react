var h=[];var R=Symbol("propsCompareFn"),L="TEXT";function z(e,t=[]){for(let n of e){let o=typeof n;if(o==="object"&&n){Array.isArray(n)?z(n,t):t.push(n);continue}(o==="string"||o==="number")&&t.push({type:L,props:{nodeValue:n},children:h,key:null})}return t.length?t:h}function s(e,t,...n){let o=t??{},r=null;return n.length>0&&(r=z(n),o.children=r),{type:e,props:o,children:r,key:o.key!==void 0?o.key:null}}function ye(e){return e===L?document.createTextNode(""):document.createElement(e)}var be="children",ge="on",X=e=>e.startsWith(ge),G=e=>e!==be&&!X(e),Q=e=>e.toLowerCase().substring(2),Z=e=>e==="className"?"class":e,ke=(e,t)=>e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t;function Te(e,t,n,o){if(t.nodeType===3){t.nodeValue!==n.nodeValue&&(t.nodeValue=n.nodeValue);return}let r=t;if(o){for(let l in o)if(!(l in n))if(G(l)){let i=Z(l);r.removeAttribute(i)}else X(l)&&r.removeEventListener(Q(l),o[l])}for(let l in n){if(o&&n[l]===o[l])continue;let i=n[l];if(G(l)&&typeof i=="string"){let c=Z(l);ke(c,r)?r[c]=i:r.setAttribute(c,i)}else if(X(l)){let c=Q(l);o&&o[l]&&r.removeEventListener(c,o[l]),r.addEventListener(c,n[l])}}r.__fiberRef=e}var U=globalThis.Node?.prototype,Ee=U?.insertBefore,ve=U?.removeChild,Fe=U?.appendChild;function Ne(e,t){ve.call(e,t)}function Se(e,t){Fe.call(e,t)}function Ce(e,t){e.replaceWith(t)}function Re(e,t,n){Ee.call(e,t,n)}var j={createNode:ye,addProps:Te,removeChild:Ne,appendChild:Se,replaceWith:Ce,insertBefore:Re};var m={node:null,hooks:[],notify:()=>{}},J=0;function ee(e,t,n){m.hooks=e,m.node=t,m.notify=n,J=0}function te(e,t,n){for(let o=e.length-1;o>=0;o--){let r=e[o];r.type===1&&(r.effect!==null&&(t.push(r.effect),r.effect=null),r.cleanup!==null&&r.changed&&(n.push(r.cleanup),r.cleanup=null,r.changed=!1))}}function xe(e){let t=m.hooks[J++];if(t)return t.node=m.node,[t.value,t.setter];let n={type:0,node:m.node,value:typeof e=="function"?e():e,setter(o){let r=n.value,l=typeof o=="function"?o:void 0,i=l?l(r):o;r!==i&&(n.value=i,m.notify(n.node))}};return m.hooks.push(n),[n.value,n.setter]}function ne(e){let t;for(let n of e)n.type===1&&n.cleanup&&((t??(t=[])).push(n.cleanup),n.cleanup=null);return t}function Me(e){let t=m.hooks[J++];if(t)return t.value;let n={type:2,value:{current:e}};return m.hooks.push(n),n.value}function oe(e,t,n){let o=Me({dispatch:void 0,initState:n?n(t):t}),[r,l]=xe(o.current.initState);if(o.current.dispatch)return[r,o.current.dispatch];function i(c){l(y=>e(y,c))}return o.current.dispatch=i,[r,i]}function v(e){return e(Ae)}function Ae(){return 100}function le(e){if(e===0)return"NoFlags";let t=[];return e&1&&t.push("Mounted"),e&4&&t.push("Moved"),e&8&&t.push("Skipped"),e&16&&t.push("Old"),t.join("|")}var re="root",k,w=[],se,u,T=[],x=[],N=[],M=[],g=j,we=!1;function P(){let e={key:null,children:h},t={parent:null,child:null,sibling:null,type:"",props:e,old:null,flags:0,dom:null,stateNode:null,children:h,from:{type:"",props:e,children:h,key:null},v:0};return we&&Object.defineProperty(t,"_flags",{get(){return le(this.flags)},enumerable:!1}),t.stateNode={current:t,hooks:[]},t}function ce(e,t,n){n&&(g=n);let o=P();o.type=re,o.dom=e,o.props={key:null,children:[t]},o.from={type:re,props:o.props,children:[t],key:null},se=o,u=o,k=o,v(D)}function De(e){let t=e.current;w.includes(t)||(w.push(t),v(D))}function He(e){return!!(e.flags&36)||!(e.flags&8)}function Oe(){for(let e of T)Le(e);if(T.splice(0),u){let e=u;for(;e;)Xe(e),e=B(e,u,He,!!(e.flags&8));for(let t=M.length-1;t>=0;t--)M[t]();if(M.splice(0),u!==se){let t=u.old,n=t.parent;if(n.child===t)n.child=u;else{let o=n.child;for(;o;){if(o.sibling===t){o.sibling=u;break}o=o.sibling}}}}u=null;for(let e=N.length-1;e>=0;e--)N[e]();N.splice(0);for(let e=x.length-1;e>=0;e--)x[e]();x.splice(0)}function W(e){return!!e.dom}function Pe(e){return typeof e.type!="string"}function Le(e){let t=e.dom??_(e,e,W)?.dom;t&&t.parentNode&&g.removeChild(t.parentNode,t);let n=e;for(;n;){if(n.stateNode.hooks.length){let o=ne(n.stateNode.hooks);o&&N.push(...o.reverse())}n=B(n,e,Pe)}e.old=null,e.child=null,e.sibling=null,e.parent=null,e.dom=null,e.stateNode=null,e.children=h}function Xe(e){if(e.flags&36){let t=e.dom??_(e,e,W)?.dom;t&&M.push(function(){let o=e.sibling?e.sibling?.dom??_(e.sibling,e,W)?.dom??null:null;t.nextSibling!=o&&g.insertBefore(t.parentNode,t,o)})}if(!(!(e.dom&&e.parent)||e.flags&8)&&(g.addProps(e,e.dom,e.props,e.old?.props||null),e.flags&1)){let t=e.parent;for(;!t.dom;)t=t.parent;let n=t.dom,o=e.dom;g.appendChild(n,o)}}function de(){if(!w.length)return null;let e=w.shift();if(e.flags&16)return de();let t=P();return t.type=e.type,t.parent=e.parent,t.child=e.child,t.sibling=e.sibling,t.old=e,t.dom=e.dom,t.props=e.props,t.v=e.v+1,t.children=e.children,t.from=e.from,t.stateNode=e.stateNode,t.stateNode.current=t,e.old=null,e.flags|=16,t}function D(e){let t=!1;for(;k&&!t;)k=Ie(k),t=e()<1;!k&&u&&Oe();let n=de();if(n){u=n,k=u,v(D);return}u&&v(D)}function Ue(e){let t=e.stateNode;if(!(e.v===0||t.hooks.length>0)){e.children=[e.type(e.props)];return}ee(t.hooks,t,De),e.children=[e.type(e.props)],te(t.hooks,x,N)}function Je(e){e.dom||(e.dom=g.createNode(e.type)),e.children=e.from.children??h}function Ie(e){return typeof e.type=="string"&&Je(e),typeof e.type=="function"&&Ue(e),e.flags&1?_e(e,e.children):e.children.length===1?Be(e,e.children[0]):Ve(e,e.children),B(e,u,We)}function We(e){return!(e.flags&8)}function B(e,t,n,o=!1){if(!o&&e.child&&n(e.child))return e.child;let r=o?e:e.child??e;for(;r&&r!==t;){let l=r.sibling;for(;l;){if(n(l))return l;l=l.sibling}r=r.parent}return null}function ie(e,t){let n=e;if(n.child)return n.child;for(;n&&n!==t;){let o=n.sibling;if(o)return o;n=n.parent}return null}function _(e,t,n){if(!e)return null;let o=ie(e,t);for(;o;){if(n(o))return o;o=ie(o,t)}return null}function _e(e,t){let n=null;for(let o=0;o<t.length;o++){let r=t[o],l=H(r,e);o===0?e.child=l:n.sibling=l,n=l}}function Be(e,t){let n=e?.old?.child;if(!n||n.from.key!==t.key)e.child=H(t,e);else if(n){e.child=ae(t,e,n);let o=n.sibling;for(;o;)T.push(o),o=o.sibling}}function Ve(e,t){if(!t.length&&e.dom&&e.parent&&e.old&&e.old.child){let d=e.old;T.push(d),e.old=null,e.flags|=1,e.children=h,e.child=null,e.dom=g.createNode(e.type);return}let n=e.old?.child??null,o=null,r=new Map,l=n,i=0;for(;l;){let d=l.from.key??i;r.set(d,{fiber:l,oldListIdx:i}),l=l.sibling,i++}let c=[],y=[];for(let d=0;d<t.length;d++){let f=t[d],Y=f.key??d,$=r.get(Y),a=null;if($){let{fiber:b,oldListIdx:me}=$;if(r.delete(Y),b.type===f.type){if(a=ae(f,e,b),c.push(a),y.push(me),b.from===f||typeof f.type!="string"&&a.type?.[R]?.(b.props,f.props)){a.flags|=8,a.child=b.child;let C=b.child;for(;C;)C.parent=a,C=C.sibling}b.sibling=null,b.parent=null}else T.push(b),a=H(f,e),a.flags|=d>i?32:4}else a=H(f,e),a.flags|=d>i?32:4;a&&(d===0?e.child=a:o.sibling=a,o=a)}if(r.forEach(d=>{T.push(d.fiber)}),y.length){let d=Ke(y);for(let f=0;f<d.length;f++)c[d[f]].flags|=4}}function H(e,t){let n=P();return n.type=e.type,n.parent=t,n.props=e.props,n.from=e,n.flags|=1,n}function ae(e,t,n){let o=P();return o.type=e.type,o.parent=t,o.old=n,o.dom=n.dom,n.flags|=16,o.props=e.props,o.v=n.v+1,o.from=e,o.stateNode=n.stateNode,o.stateNode.current=o,o}function Ke(e){if(e.length===0)return[];let t=[e[0]],n=[1];for(let l=1;l<e.length;l++){let i=e[l];if(i>=t[t.length-1])t.push(i),n.push(t.length);else if(i<=t[0])t[0]=i,n.push(1);else{let c=1,y=t.length-1;for(;c<y;){let d=c+y>>>1;t[d]<i?c=d+1:y=d}t[c]=i,n.push(c+1)}}let o=t.length,r=[];for(let l=e.length-1;l>=0;l--)n[l]===o&&o>0?o--:r.push(l);return r}function qe(e,t){if(e===t)return!0;let n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(let r=0;r<n.length;r++){let l=n[r];if(e[l]!==t[l])return!1}return!0}function V(e,t=qe){function n(o){return e(o)}return n[R]=t,n}var K=e=>Math.round(Math.random()*1e3)%e,ue=["pretty","large","big","small","tall","short","long","handsome","plain","quaint","clean","elegant","easy","angry","crazy","helpful","mushy","odd","unsightly","adorable","important","inexpensive","cheap","expensive","fancy"],pe=["red","yellow","blue","green","pink","brown","purple","brown","white","black","orange"],fe=["table","chair","house","bbq","desk","car","pony","cookie","sandwich","burger","pizza","mouse","keyboard"],Ye=1,q=e=>{let t=new Array(e);for(let n=0;n<e;n++)t[n]={id:Ye++,label:`${ue[K(ue.length)]} ${pe[K(pe.length)]} ${fe[K(fe.length)]}`};return t},$e={data:[],selected:0},ze=(e,t)=>{let{data:n,selected:o}=e;switch(t.type){case"RUN":return{data:q(1e3),selected:0};case"RUN_LOTS":return{data:q(1e4),selected:0};case"ADD":return{data:n.concat(q(1e3)),selected:o};case"UPDATE":{let l=n.slice(0);for(let i=0;i<l.length;i+=10){let c=l[i];l[i]={id:c.id,label:c.label+" !!!"}}return{data:l,selected:o}}case"CLEAR":return{data:[],selected:0};case"SWAP_ROWS":let r=[...n];if(n.length>998){let l=r[1],i=r[998];r[1]=i,r[998]=l}return{data:r,selected:o};case"REMOVE":{let l=n.findIndex(i=>i.id===t.id);return{data:[...n.slice(0,l),...n.slice(l+1)],selected:o}}case"SELECT":return{data:n,selected:t.id};default:return e}},Ge=V(({selected:e,item:t,dispatch:n})=>s("tr",{className:e?"danger":""},s("td",{className:"col-md-1"},t.id),s("td",{className:"col-md-4"},s("a",{onClick:()=>n({type:"SELECT",id:t.id})},t.label)),s("td",{className:"col-md-1"},s("a",{onClick:()=>n({type:"REMOVE",id:t.id})},s("span",{className:"glyphicon glyphicon-remove","aria-hidden":"true"}))),s("td",{className:"col-md-6"})),(e,t)=>e.selected===t.selected&&e.item===t.item),E=({id:e,cb:t,title:n})=>s("div",{className:"col-sm-6 smallpad"},s("button",{type:"button",className:"btn btn-primary btn-block",id:e,onClick:t},n)),Qe=V(({dispatch:e})=>s("div",{className:"jumbotron"},s("div",{className:"row"},s("div",{className:"col-md-6"},s("h1",null,"React Hooks keyed")),s("div",{className:"col-md-6"},s("div",{className:"row"},s(E,{id:"run",title:"Create 1,000 rows",cb:()=>e({type:"RUN"})}),s(E,{id:"runlots",title:"Create 10,000 rows",cb:()=>e({type:"RUN_LOTS"})}),s(E,{id:"add",title:"Append 1,000 rows",cb:()=>e({type:"ADD"})}),s(E,{id:"update",title:"Update every 10th row",cb:()=>e({type:"UPDATE"})}),s(E,{id:"clear",title:"Clear",cb:()=>e({type:"CLEAR"})}),s(E,{id:"swaprows",title:"Swap Rows",cb:()=>e({type:"SWAP_ROWS"})}))))),()=>!0),he=({dispatchRef:e})=>{let[{data:t,selected:n},o]=oe(ze,$e);return e.current=o,s("div",{className:"container"},s(Qe,{dispatch:o}),s("table",{className:"table table-hover table-striped test-data"},s("tbody",null,t.map(r=>s(Ge,{key:r.id,item:r,selected:n===r.id,dispatch:o})))),s("span",{className:"preloadicon glyphicon glyphicon-remove","aria-hidden":"true"}))};var Ze={},je={createNode:()=>Ze,addProps:()=>{},removeChild:()=>{},replaceWith:()=>{},appendChild:()=>{},insertBefore:()=>{}},p={current:null},et=performance.now();ce(void 0,s(he,{dispatchRef:p}),je);if(!p.current)throw new Error("dispatch did not bind");p.current({type:"RUN_LOTS"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});p.current({type:"UPDATE"});var tt=performance.now();console.log(`bench-1k: took ${tt-et} ms`);
